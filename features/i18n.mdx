---
title: å›½é™…åŒ–
description: "ä½¿ç”¨ next-intl å®ç°å¤šè¯­è¨€æ”¯æŒ"
---

# å›½é™…åŒ–

Codofly Template ä½¿ç”¨ next-intl æä¾›å®Œæ•´çš„å›½é™…åŒ–æ”¯æŒï¼Œç›®å‰æ”¯æŒè‹±æ–‡å’Œç®€ä½“ä¸­æ–‡ã€‚

## next-intl é…ç½®

### åŸºç¡€é…ç½®

```typescript title="i18n.ts"
import { notFound } from 'next/navigation'
import { getRequestConfig } from 'next-intl/server'

// æ”¯æŒçš„è¯­è¨€åˆ—è¡¨
export const locales = ['en', 'zh'] as const
export type Locale = typeof locales[number]

export default getRequestConfig(async ({ locale }) => {
  // éªŒè¯è¯­è¨€æ˜¯å¦æ”¯æŒ
  if (!locales.includes(locale as any)) notFound()

  return {
    messages: (await import(`./messages/${locale}.json`)).default
  }
})
```

### ä¸­é—´ä»¶é…ç½®

```typescript title="middleware.ts"
import createMiddleware from 'next-intl/middleware'
import { locales } from './i18n'

export default createMiddleware({
  locales,
  defaultLocale: 'en',
  localePrefix: 'always'
})

export const config = {
  matcher: ['/((?!api|_next|_vercel|.*\\..*).*)']
}
```

## ç¿»è¯‘æ–‡ä»¶ç®¡ç†

### è‹±æ–‡ç¿»è¯‘

```json title="messages/en.json"
{
  "Common": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "loading": "Loading...",
    "error": "An error occurred"
  },
  "Navigation": {
    "home": "Home",
    "dashboard": "Dashboard",
    "teams": "Teams",
    "settings": "Settings",
    "signIn": "Sign In",
    "signOut": "Sign Out"
  },
  "HomePage": {
    "title": "Build AI SaaS Apps Fast",
    "subtitle": "Everything you need to launch your AI-powered SaaS",
    "getStarted": "Get Started",
    "learnMore": "Learn More"
  },
  "Features": {
    "ai": {
      "title": "Multi-AI Integration",
      "description": "Support for OpenAI, Anthropic, and Google models"
    },
    "auth": {
      "title": "User Authentication",
      "description": "Complete auth system with social login"
    },
    "teams": {
      "title": "Team Collaboration",
      "description": "Built-in team management and sharing"
    }
  }
}
```

### ä¸­æ–‡ç¿»è¯‘

```json title="messages/zh.json"
{
  "Common": {
    "save": "ä¿å­˜",
    "cancel": "å–æ¶ˆ",
    "delete": "åˆ é™¤",
    "edit": "ç¼–è¾‘",
    "loading": "åŠ è½½ä¸­...",
    "error": "å‘ç”Ÿé”™è¯¯"
  },
  "Navigation": {
    "home": "é¦–é¡µ",
    "dashboard": "ä»ªè¡¨ç›˜",
    "teams": "å›¢é˜Ÿ",
    "settings": "è®¾ç½®",
    "signIn": "ç™»å½•",
    "signOut": "é€€å‡º"
  },
  "HomePage": {
    "title": "å¿«é€Ÿæ„å»º AI SaaS åº”ç”¨",
    "subtitle": "å¯åŠ¨ AI é©±åŠ¨çš„ SaaS æ‰€éœ€çš„ä¸€åˆ‡",
    "getStarted": "å¼€å§‹ä½¿ç”¨",
    "learnMore": "äº†è§£æ›´å¤š"
  },
  "Features": {
    "ai": {
      "title": "å¤š AI æ¨¡å‹é›†æˆ",
      "description": "æ”¯æŒ OpenAIã€Anthropic å’Œ Google æ¨¡å‹"
    },
    "auth": {
      "title": "ç”¨æˆ·è®¤è¯",
      "description": "å®Œæ•´çš„è®¤è¯ç³»ç»Ÿï¼Œæ”¯æŒç¤¾äº¤ç™»å½•"
    },
    "teams": {
      "title": "å›¢é˜Ÿåä½œ",
      "description": "å†…ç½®å›¢é˜Ÿç®¡ç†å’Œå…±äº«åŠŸèƒ½"
    }
  }
}
```

## å¤šè¯­è¨€è·¯ç”±

### æ ¹å¸ƒå±€

```typescript title="app/[locale]/layout.tsx"
import { NextIntlClientProvider } from 'next-intl'
import { getMessages } from 'next-intl/server'
import { setRequestLocale } from 'next-intl/server'
import { locales } from '@/i18n'

export function generateStaticParams() {
  return locales.map((locale) => ({ locale }))
}

interface Props {
  children: React.ReactNode
  params: { locale: string }
}

export default async function LocaleLayout({
  children,
  params: { locale }
}: Props) {
  // å¯ç”¨é™æ€æ¸²æŸ“
  setRequestLocale(locale)
  
  const messages = await getMessages()

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  )
}
```

### é¡µé¢å›½é™…åŒ–

```typescript title="app/[locale]/page.tsx"
import { useTranslations } from 'next-intl'
import { setRequestLocale } from 'next-intl/server'

interface Props {
  params: { locale: string }
}

export default function HomePage({ params: { locale } }: Props) {
  setRequestLocale(locale)
  
  const t = useTranslations('HomePage')

  return (
    <div className="text-center">
      <h1 className="text-4xl font-bold">{t('title')}</h1>
      <p className="text-xl text-gray-600 mt-4">{t('subtitle')}</p>
      <div className="mt-8 space-x-4">
        <button className="bg-blue-500 text-white px-6 py-2 rounded">
          {t('getStarted')}
        </button>
        <button className="border border-gray-300 px-6 py-2 rounded">
          {t('learnMore')}
        </button>
      </div>
    </div>
  )
}
```

## è¯­è¨€åˆ‡æ¢

### è¯­è¨€åˆ‡æ¢ç»„ä»¶

```typescript title="components/language-switcher.tsx"
'use client'

import { useLocale } from 'next-intl'
import { usePathname, useRouter } from 'next/navigation'
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'

const languages = [
  { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
  { code: 'zh', name: 'ç®€ä½“ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' }
]

export function LanguageSwitcher() {
  const locale = useLocale()
  const router = useRouter()
  const pathname = usePathname()

  const handleLanguageChange = (newLocale: string) => {
    // ç§»é™¤å½“å‰è¯­è¨€å‰ç¼€
    const pathWithoutLocale = pathname.replace(`/${locale}`, '') || '/'
    
    // æ·»åŠ æ–°è¯­è¨€å‰ç¼€
    const newPath = `/${newLocale}${pathWithoutLocale}`
    
    router.push(newPath)
  }

  return (
    <Select value={locale} onValueChange={handleLanguageChange}>
      <SelectTrigger className="w-40">
        <SelectValue>
          {languages.find(lang => lang.code === locale)?.flag}{' '}
          {languages.find(lang => lang.code === locale)?.name}
        </SelectValue>
      </SelectTrigger>
      <SelectContent>
        {languages.map(language => (
          <SelectItem key={language.code} value={language.code}>
            {language.flag} {language.name}
          </SelectItem>
        ))}
      </SelectContent>
    </Select>
  )
}
```

### å¯¼èˆªæ é›†æˆ

```typescript title="components/navbar.tsx"
import { useTranslations } from 'next-intl'
import { LanguageSwitcher } from './language-switcher'
import { Link } from '@/navigation'

export function Navbar() {
  const t = useTranslations('Navigation')

  return (
    <nav className="flex items-center justify-between p-4">
      <div className="flex space-x-6">
        <Link href="/">{t('home')}</Link>
        <Link href="/dashboard">{t('dashboard')}</Link>
        <Link href="/teams">{t('teams')}</Link>
      </div>
      
      <div className="flex items-center space-x-4">
        <LanguageSwitcher />
        <Link href="/auth/signin">{t('signIn')}</Link>
      </div>
    </nav>
  )
}
```

## å†…å®¹æœ¬åœ°åŒ–

### æ—¥æœŸå’Œæ—¶é—´

```typescript title="lib/date-formatter.ts"
import { useLocale } from 'next-intl'

export function useDateFormatter() {
  const locale = useLocale()

  const formatDate = (date: Date) => {
    return new Intl.DateTimeFormat(locale, {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    }).format(date)
  }

  const formatDateTime = (date: Date) => {
    return new Intl.DateTimeFormat(locale, {
      year: 'numeric',
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    }).format(date)
  }

  return { formatDate, formatDateTime }
}
```

### æ•°å­—æ ¼å¼åŒ–

```typescript title="components/price-display.tsx"
import { useLocale } from 'next-intl'

interface PriceDisplayProps {
  amount: number
  currency?: string
}

export function PriceDisplay({ amount, currency = 'USD' }: PriceDisplayProps) {
  const locale = useLocale()

  const formatPrice = (amount: number, currency: string) => {
    return new Intl.NumberFormat(locale, {
      style: 'currency',
      currency: currency
    }).format(amount)
  }

  return <span>{formatPrice(amount, currency)}</span>
}
```

### å¤æ•°å¤„ç†

```typescript title="components/message-count.tsx"
import { useTranslations } from 'next-intl'

interface MessageCountProps {
  count: number
}

export function MessageCount({ count }: MessageCountProps) {
  const t = useTranslations('Messages')

  return (
    <span>
      {t('count', { count })}
    </span>
  )
}
```

å¯¹åº”çš„ç¿»è¯‘æ–‡ä»¶ï¼š
```json
{
  "Messages": {
    "count": {
      "0": "No messages",
      "1": "1 message", 
      "other": "{count} messages"
    }
  }
}
```

## åŠ¨æ€å¯¼å…¥ç¿»è¯‘

### æŒ‰éœ€åŠ è½½ç¿»è¯‘

```typescript title="lib/translations.ts"
export async function loadTranslations(locale: string, namespace: string) {
  try {
    const messages = await import(`@/messages/${locale}/${namespace}.json`)
    return messages.default
  } catch (error) {
    console.warn(`Failed to load ${namespace} translations for ${locale}`)
    return {}
  }
}
```

### åˆ†ç¦»ç¿»è¯‘æ–‡ä»¶

```
messages/
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ common.json
â”‚   â”œâ”€â”€ navigation.json
â”‚   â”œâ”€â”€ auth.json
â”‚   â””â”€â”€ dashboard.json
â””â”€â”€ zh/
    â”œâ”€â”€ common.json
    â”œâ”€â”€ navigation.json
    â”œâ”€â”€ auth.json
    â””â”€â”€ dashboard.json
```

## æ·»åŠ æ–°è¯­è¨€

### æ­¥éª¤

1. **æ·»åŠ è¯­è¨€åˆ°é…ç½®**

```typescript title="i18n.ts"
export const locales = ['en', 'zh', 'ja'] as const // æ·»åŠ æ—¥è¯­
```

2. **åˆ›å»ºç¿»è¯‘æ–‡ä»¶**

```json title="messages/ja.json"
{
  "Common": {
    "save": "ä¿å­˜",
    "cancel": "ã‚­ãƒ£ãƒ³ã‚»ãƒ«",
    "delete": "å‰Šé™¤"
  }
}
```

3. **æ›´æ–°è¯­è¨€åˆ‡æ¢å™¨**

```typescript title="components/language-switcher.tsx"
const languages = [
  { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
  { code: 'zh', name: 'ç®€ä½“ä¸­æ–‡', flag: 'ğŸ‡¨ğŸ‡³' },
  { code: 'ja', name: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' } // æ·»åŠ æ—¥è¯­
]
```

## æœåŠ¡ç«¯ç»„ä»¶ç¿»è¯‘

### API å“åº”æœ¬åœ°åŒ–

```typescript title="app/api/messages/route.ts"
import { getTranslations } from 'next-intl/server'

export async function POST(request: Request) {
  const { locale } = await request.json()
  const t = await getTranslations({ locale, namespace: 'API' })

  try {
    // å¤„ç†é€»è¾‘
    return NextResponse.json({
      message: t('success')
    })
  } catch (error) {
    return NextResponse.json({
      error: t('error')
    }, { status: 500 })
  }
}
```

## æœ€ä½³å®è·µ

### 1. ç¿»è¯‘é”®å‘½å

```typescript
// âœ… å¥½çš„å‘½å
"Auth.SignIn.title"
"Dashboard.Stats.users"
"Teams.Members.invite"

// âŒ é¿å…çš„å‘½å
"text1"
"message"
"button"
```

### 2. ç¿»è¯‘æ–‡ä»¶ç»“æ„

```json
{
  "ComponentName": {
    "title": "æ ‡é¢˜",
    "description": "æè¿°",
    "actions": {
      "save": "ä¿å­˜",
      "cancel": "å–æ¶ˆ"
    }
  }
}
```

### 3. å¤„ç†ç¼ºå¤±ç¿»è¯‘

```typescript title="lib/fallback-translations.ts"
export function withFallback(key: string, fallback: string) {
  const t = useTranslations()
  
  try {
    return t(key)
  } catch {
    return fallback
  }
}
```

<Callout type="info">
  å»ºè®®ä½¿ç”¨ä¸“ä¸šç¿»è¯‘å·¥å…·å¦‚ Crowdin æˆ– Lokalise æ¥ç®¡ç†å¤§å‹é¡¹ç›®çš„ç¿»è¯‘å·¥ä½œã€‚
</Callout>

## æ€§èƒ½ä¼˜åŒ–

### ç¿»è¯‘é¢„åŠ è½½

```typescript title="app/[locale]/loading.tsx"
import { getMessages } from 'next-intl/server'

export default async function Loading({ params: { locale } }) {
  // é¢„åŠ è½½ç¿»è¯‘
  await getMessages()
  
  return <div>Loading...</div>
}
```

### é™æ€ç”Ÿæˆ

```typescript title="next.config.js"
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    ppr: true, // å¯ç”¨éƒ¨åˆ†é¢„æ¸²æŸ“
  },
}

module.exports = nextConfig
```

<Note>
  æŸ¥çœ‹ [next-intl æ–‡æ¡£](https://next-intl-docs.vercel.app/) äº†è§£æ›´å¤šé«˜çº§åŠŸèƒ½ã€‚
</Note>